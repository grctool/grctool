# Evidence Collection: {{.Task.Name}}

## üìã REQUIRED OUTPUT FORMAT

Provide ONLY the evidence artifacts listed below. Do NOT include analysis, interpretation, or explanations of compliance. Focus on concrete, verifiable evidence.

**Required Sections:**
1. **Evidence Items** - List each piece of evidence with source reference
2. **Verification Notes** - Brief notes on how auditors can verify (optional, max 1-2 sentences per item)

**Output Structure:**
```markdown
## Evidence Items

### [Evidence Type] - [Brief Title]
- **Source**: [System/Tool/File]
- **Evidence**:
  [Actual configuration, log entry, API response, or data]
- **Verification**: [How auditors can verify this - optional, keep brief]

### [Next Evidence Item]
...
```

**Critical Instructions:**
- ‚úÖ DO: Provide actual configs, logs, API outputs, file contents, terraform resources
- ‚úÖ DO: Include specific resource names, IDs, timestamps, values
- ‚ùå DON'T: Explain WHY something demonstrates compliance
- ‚ùå DON'T: Write executive summaries or interpretive analysis
- ‚ùå DON'T: Include lengthy descriptions of what controls require

---

## üéØ Evidence Task Details

**Task ID**: {{.Task.ReferenceID}}
**Description**: {{.Task.Description}}
{{- if .Task.Guidance}}
**Collection Guidance**: {{.Task.Guidance}}
{{- end}}
{{- if .Task.Sensitive}}
‚ö†Ô∏è **SENSITIVE DATA NOTICE**: Redact PII - use examples or anonymized samples only
{{- end}}
{{- if .Task.CollectionInterval}}
**Collection Frequency**: {{.Task.CollectionInterval}}
{{- end}}

{{- if and .Controls .ControlSummaries}}
**Target Controls** (Collect evidence for these):
{{- range .Controls}}
{{- $controlID := .ID}}
{{- with index $.ControlSummaries $controlID}}
- **[{{.ControlID}}] {{.ControlName}}** - {{.Summary}}
  {{- if .KeyRequirements}}
  Requirements: {{range $i, $req := .KeyRequirements}}{{if $i}}, {{end}}{{$req}}{{end}}
  {{- end}}
{{- else}}
- **[{{$controlID}}] {{.Name}}**
{{- end}}
{{- end}}
{{- else if .Controls}}
**Target Controls**:
{{- range $i, $control := .Controls}}
{{- if ge $i 5}}
... and {{len $.Controls | add -5}} more controls (see task details)
{{- break}}
{{- end}}
- **[{{.ID}}] {{.Name}}** - {{.Body | truncate 200}}
{{- end}}
{{- end}}

{{- if and .Policies .PolicySummaries}}
**Relevant Policies**:
{{- range .Policies}}
{{- $policyID := .ID.String}}
{{- with index $.PolicySummaries $policyID}}
- **[{{.PolicyID}}] {{.PolicyName}}** - {{.Summary}}
{{- else}}
- **[{{$policyID}}] {{.Name}}**
{{- end}}
{{- end}}
{{- else if .Policies}}
**Relevant Policies**:
{{- range $i, $policy := .Policies}}
{{- if ge $i 3}}
... and {{len $.Policies | add -3}} more policies (see task details)
{{- break}}
{{- end}}
- **[{{.ID.String}}] {{.Name}}** - {{.Description | truncate 150}}
{{- end}}
{{- end}}

{{- if .FrameworkReqs}}
**Framework Requirements**: {{join .FrameworkReqs ", "}}
{{- end}}

---

## üîß Available Tools

Use these tools to collect evidence. Run them and include their output in your evidence items.

{{- if .AvailableTools}}
{{- range .AvailableTools}}
- **`grctool tool {{.Name}}`** - {{.Description}}
{{- end}}

**Tool Usage Format**: `grctool tool [tool-name] --task-ref {{.Task.ReferenceID}} --output json`
{{- else}}
No specific tools configured for this task. Use manual evidence collection.
{{- end}}

---

## üì¶ Evidence Collection Checklist

Collect the following types of evidence (where applicable):

**Configuration Evidence:**
- [ ] System settings (terraform configs, API responses, console exports)
- [ ] Access controls (IAM policies, role assignments, permission matrices)
- [ ] Security features (encryption settings, MFA status, firewall rules)

**Process Evidence:**
- [ ] Documented procedures (policy files, runbooks, SOPs)
- [ ] Approval workflows (PR approvals, change management records)
- [ ] Review records (audit logs, review comments)

**Monitoring Evidence:**
- [ ] Log configurations (logging enabled, retention policies)
- [ ] Alert configurations (monitoring rules, notification settings)
- [ ] Audit trails (access logs, change logs, activity records)

{{- if and .SecurityMappings .SecurityMappings.SOC2}}

**Relevant Technical Areas**:
{{- range $code, $mapping := .SecurityMappings.SOC2}}
{{- if $mapping.TerraformResources}}
- {{$code}}: {{join $mapping.TerraformResources ", "}}
{{- end}}
{{- end}}
{{- end}}

---

**Start collecting evidence now. Remember: Show, don't tell. Provide artifacts, not analysis.**